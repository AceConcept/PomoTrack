version: 2
jobs:
  build:
    working_directory: /app
    docker:
    - image: docker:stable
    steps:
    - checkout
    - setup_remote_docker
    - run:
        name: Install dependencies
        command: |
          apk add --no-cache bash curl
    - run:
        name: Build Docker image
        command: |
          docker build \
                 -f docker/Dockerfile \
                 -t todo-vue-test \
                 .
    - run:
        name: Run lint and unit testing
        command: |
          docker run -i --rm \
                 todo-vue-test \
                 sh -c 'yarn run lint && yarn run test:unit'